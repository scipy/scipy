# Contributed by Thouis Jones, 2009.
from numpy import log, array, isfinite, inf
from quadrature import vectorize1

__all__ = ["quad_de"]

def quad_de(func, a, b, args=(), tol=1e-10, vec_func=True):
    """
    Integrate a function over an interval using double exponential
    quadrature.

    Double exponential quadrature (AKA double exponential integration
    and tanh-sinh quadrature [TS]) is an integration method introduced
    by Takahashi and Mori in 1974 [TM].  The method applies a change
    of variables to map the integration limits to [-inf, inf], with a
    doubly exponential falloff in either direction, then uses
    quadrature with uniform intervals to compute the integral.

    This method is well-suited to integrating analytic functions,
    particularly those with a singularity at one or both endpoints.
    It should not be used with functions with discontinuities.  

    If quad_de() encounters a singularity (+/-infinity or NaN) within
    the integration limits, it will raise a ValueError.

    Parameters
    ----------
    func : function
        The integrand
    a : float
        Lower integration limit
    b : float
        Upper integration limit
    tol : float, optional
        Desired absolute error tolerance.
    vec_func : bool, optional
        Whether the function is vectorized.
    
    Returns
    -------
    val : float
        Estimated value of the integral
    err : float
        Estimated error
    
    Raises
    ------
    ValueError
        If the function returns non-finite values.
    
    See Also
    --------
    quad
    
    Notes
    -----
    This is based on John D. Cook's implementation [FN, DE], used with
    permission.
    
    References
    ----------
    .. [DE] http://www.johndcook.com/double_exponential_integration.html
    .. [FN] http://www.codeproject.com/KB/recipes/FastNumericalIntegration.aspx
    .. [TH] http://en.wikipedia.org/wiki/Tanh-sinh_quadrature
    .. [TM] Double exponential formulas for numerical integration, 
            Hidetosi Takahasi and Masatake Mori 
            Publ. Res. Inst. Math. Sci. Volume 9, Number 3 (1973), 721-741.  
            http://dx.doi.org/10.2977%2Fprims%2F1195192451 
    """

    # vectorize func, and fold in args
    vfunc = vectorize1(func, args, vec_func=vec_func)
    
    # linear change of variables from (a,b) to (-1, 1)
    # Int[f(x), {x,a,b}] = c*Int[f(ct+d), {t,-1,1}]
    c = float(b - a) / 2
    d = float(a + b) / 2
    
    def contribution_at_level(l):
        # _abscissas and _weights are defined below
        return (2.0**(-l) * _weights[l] * vfunc(c * _abscissas[l] + d)).sum()

    def raise_bad_value(l):
        vals = vfunc(c * _abscissas[l] + d)
        raise ValueError('Singularities encountered in quad_de evaluating %s([%s]) = [%s]', 
                         func.__name__, 
                         ", ".join(['%f'%v for v in (c * _abscissas[l] + d)[~isfinite(vals)]]),
                         ", ".join(['%f'%v for v in vals[~isfinite(vals)]]))

    integral = contribution_at_level(0)
    if not isfinite(integral):
        raise_bad_value(0)
    current_delta = inf

    for level in range(1, len(_abscissas)):
        new_contribution = contribution_at_level(level)

        previous_delta = current_delta
        current_delta = abs(integral / 2 - new_contribution)

        integral = integral / 2 + new_contribution
        
        if not isfinite(integral):
            raise_bad_value(level)

        if current_delta == 0.0:
            error_estimate = 0.0
            break

        if level == 1:
            continue

        # both of these are nonzero, or we would have already exited.
        r = log(current_delta) / log(previous_delta)
        
        if 1.9 < r < 2.1:
            # If convergence theory applied perfectly, r would be 2 in
            # the convergence region.  r close to 2 is good enough. We
            # expect the difference between this integral estimate and
            # the next one to be roughly delta^2.
            error_estimate = c * current_delta ** 2
        else:
            # not yet converging
            error_estimate = c * current_delta * 2

        if error_estimate < 0.1 * tol:
            break

    value = c * integral * _initial_step_size
    error = _initial_step_size * error_estimate
    return value, error

# These are computed from doubleexp_generators.abw_m1_1() for the
# transformed range [-3.155,3.155] (the abscissa at 3.155 is just above
# 1-eps, above which point all abscissa become the same).
#
# This points out one way that the integrator's accuracy might be
# improved: accept two versions of f(), one for points near the lower
# boundary, one for points nearer the upper boundary, with the point
# expressed as the distance from that boundary.  Another improvement
# would involve passing in the weight to be incorporated directly into
# the computation of f().  For functions that are more easily computed
# in the log domain, this could help preserve accuracy.

_initial_step_size = 3.155 / 4.0

_abscissas_raw = [[0.0, 0.87903063144892879, 0.99862635882671236,
0.99999987562836345, 0.99999999999999978], [0.56194158995164889,
0.98099763834412679, 0.99996873564632527, 0.99999999996377775],
[0.30203064541992142, 0.75495436837352903, 0.94804456530865755,
0.994260503878027, 0.99975294838108641, 0.99999743082291248,
0.9999999968483585, 0.99999999999984135], [0.15388937328657493,
0.43934298737295324, 0.66743347066377834, 0.82498568550101647,
0.91923773501276218, 0.96788763737643602, 0.98927893575875281,
0.99710050759978519, 0.9993939764415023, 0.9999077385388464,
0.99999048706254279, 0.99999939192260645, 0.99999997835406096,
0.99999999962324304, 0.9999999999972623, 0.99999999999999312],
[0.077312127080129023, 0.22901888286748773, 0.37231601010990728,
0.50266769327574456, 0.61691447770996644, 0.71343841457751322,
0.79208186393600777, 0.85388287947667385, 0.90071454437912302,
0.93491104666539238, 0.95894052858048606, 0.97515671797804993,
0.98563735315348633, 0.99210144856675275, 0.99588937268111322,
0.99798735693944407, 0.99907901737572768, 0.99960902070259117,
0.99984727457587463, 0.9999456017371815, 0.99998250837772318,
0.99999497818564187, 0.99999872823314429, 0.99999971967020129,
0.99999994700227501, 0.99999999154460839, 0.99999999888173707,
0.99999999987979005, 0.99999999998972211, 0.99999999999931755,
0.99999999999996569, 0.99999999999999867], [0.038702254700251723,
0.11573793271335936, 0.19167820568021554, 0.26582915819837816,
0.33754932771685014, 0.40626671069109316, 0.47149219804936715,
0.53282894174668793, 0.58997745840029614, 0.64273656862315531,
0.69100052464192396, 0.73475287483724605, 0.77405774192879484,
0.80904925062015365, 0.83991983712983598, 0.86690811893601893,
0.89028691276315441, 0.91035187726867317, 0.92741113759009963,
0.94177613287674977, 0.95375382306048484, 0.96364030223061203,
0.97171579515692119, 0.97824096068973998, 0.9834543893923311,
0.98757116038144099, 0.99078231116216398, 0.99325507148573389,
0.99513371549507845, 0.99654089368630527, 0.99757931605859917,
0.99833366929208722, 0.99887266332192814, 0.99925111597814198,
0.99951199828183068, 0.99968837738942395, 0.99980520883708812,
0.99988094430828833, 0.99992893515156855, 0.99995862475410013,
0.99997653406709952, 0.99998705360640572, 0.99999306180764325,
0.99999639361295689, 0.99999818475056479, 0.99999911668879327,
0.99999958519465837, 0.99999981235791846, 0.99999991839174907,
0.99999996594531126, 0.99999998639382015, 0.99999999480669932,
0.99999999811078244, 0.99999999934659223, 0.99999999978569631,
0.99999999993352762, 0.99999999998055611, 0.99999999999465239,
0.99999999999862144, 0.99999999999966793, 0.9999999999999255,
0.99999999999998446, 0.999999999999997, 0.99999999999999944],
[0.019356909447331528, 0.058024493449520625, 0.096553722328554373,
0.13485351966552703, 0.17283453266452539, 0.21040978823918752,
0.24749531661309601, 0.28401073437287971, 0.31987977977479543,
0.35503079410237526, 0.38939714397434882, 0.42291758067614116,
0.4555365338014748, 0.4872043377099573, 0.51787739050046588,
0.5475182463396544, 0.57609564304442529, 0.60358446777524943,
0.62996566453685388, 0.65522608789189096, 0.67935830786442175,
0.70236037144068553, 0.72423552636627686, 0.74499191309690682,
0.76464223079303117, 0.78320338316801996, 0.80069610981842587,
0.81714460839775926, 0.832576152657164, 0.84702071098278597,
0.86051056962532857, 0.87307996435639845, 0.88476472381174975,
0.89560192730505839, 0.90562957942751643, 0.91488630329684772,
0.9234110538912077, 0.93124285250418648, 0.93842054299061828,
0.94498257014160936, 0.9509667802323778, 0.95641024352836446,
0.96134909831292803, 0.96581841581235695, 0.9698520852389394,
0.97348271804802522, 0.97674157040771559, 0.97965848280720735,
0.98226183567901793, 0.98457851987850553, 0.98663392084856183,
0.98845191529556664, 0.9900548792123377, 0.99146370610282464,
0.99269783428987834, 0.99377528222004663, 0.99471269071673474,
0.99552537117419271, 0.9962273587288708, 0.99683146949110724,
0.99734936096846094, 0.9977915948619811, 0.99816770146811562,
0.99848624497168459, 0.99875488896926601, 0.99898046161738518,
0.99916901985591855, 0.99932591221396883, 0.99945583976289221,
0.99956291483886583, 0.99965071721498977, 0.99972234745998079,
0.99978047727651187, 0.99982739666664522, 0.99986505782399693,
0.99989511570168577, 0.99991896525118729, 0.99993777536941342,
0.99995251962921716, 0.99996400390171369, 0.99997289100704667,
0.9999797225533632, 0.9999849381417677, 0.99998889212799114,
0.99999186813965024, 0.99999409155158714, 0.99999574012129688,
0.99999695298231561, 0.99999783818622079, 0.99999847897411376,
0.99999893894670899, 0.99999926628898217, 0.99999949719127634,
0.99999965859429363, 0.99999977037096166, 0.99999984704409439,
0.99999989912538434, 0.99999993414876898, 0.99999995745977988,
0.99999997281219788, 0.99999998281423486, 0.99999998925854727,
0.99999999336360035, 0.99999999594817812, 0.99999999755608404,
0.99999999854418253, 0.99999999914379933, 0.99999999950300478,
0.9999999997153618, 0.99999999983921273, 0.99999999991044763,
0.99999999995083977, 0.99999999997341071, 0.99999999998583589,
0.9999999999925715, 0.99999999999616584, 0.99999999999805322,
0.999999999999028, 0.99999999999952294, 0.99999999999976996,
0.99999999999989109, 0.99999999999994937, 0.99999999999997691,
0.99999999999998967, 0.99999999999999545, 0.999999999999998,
0.99999999999999911, 0.99999999999999956], [0.0096791777424693696,
0.029031749761486269, 0.048366982330085254, 0.067673352267730816,
0.086939390940424424, 0.10615370581392004, 0.12530500174329795,
0.14438210192606576, 0.16337396844779914, 0.18226972235155717,
0.20105866316489171, 0.21973028782119614, 0.23827430891538096,
0.25668067223740076, 0.27493957353095866, 0.29304147442875106,
0.31097711751986162, 0.32873754050932935, 0.34631408943447695,
0.3636984309072564, 0.38088256335661236, 0.39785882724965538,
0.41461991427523531, 0.43115887547828802, 0.44746912833805425,
0.46354446278792077, 0.47937904617917265, 0.49496742719535186,
0.51030453872816584, 0.52538569972995475, 0.54020661606159404,
0.55476338035835548, 0.5690524709396636, 0.58307074979185158,
0.59681545965592964, 0.61028422025502194, 0.62347502369849839,
0.63638622910192733, 0.64901655646378786, 0.66136507984142889,
0.67343121987002807, 0.68521473566930347, 0.69671571618347117,
0.70793457100042079, 0.71887202069631895, 0.72952908675185679,
0.73990708108612879, 0.75000759525370819, 0.75983248934984526,
0.76938388066791452, 0.77866413215224639, 0.78767584068835494,
0.79642182527129191, 0.80490511509147278, 0.81312893757580673,
0.82109670642037325, 0.82881200964920632, 0.8362785977320113,
0.84350037179184056, 0.85048137193193252, 0.85722576570905107,
0.86373783677880378, 0.8700219737365319, 0.87608265917551054,
0.88192445898233773, 0.88755201188757327, 0.89297001928789743,
0.89818323535430489, 0.90319645743915211, 0.90801451679322165,
0.91264226960237416, 0.91708458835182871, 0.92134635352464056,
0.92543244563955074, 0.92934773763204526, 0.93309708758120802,
0.93668533178375779, 0.94011727817554958, 0.94339770009977197,
0.94653133042010473, 0.94952285597619568, 0.95237691237798794,
0.95509807913466027, 0.95769087511325002, 0.96015975432139034,
0.96250910200802109, 0.96474323107542359, 0.96686637879546422,
0.96888270382253883, 0.97079628349534874, 0.97261111141934065,
0.97433109532138329, 0.97596005516803574, 0.97750172153858927,
0.97895973424392269, 0.98033764118210853, 0.98163889742163257,
0.98286686450304694, 0.98402480994985841, 0.98511590697946061,
0.98614323440495133, 0.98710977671871969, 0.98801842434876197,
0.98887197407876459, 0.98967312962309306, 0.99042450234793722,
0.99112861212998571, 0.99178788834413756, 0.99240467097190088,
0.99298121182227872, 0.99351967585710255, 0.99402214261293653,
0.99449060771184539, 0.99492698445349681, 0.99533310548124565,
0.99571072451503218, 0.99606151814411592, 0.99638708767285367,
0.99668896101292737, 0.99696859461562326, 0.99722737543796314,
0.99746662293669008, 0.99768759108431915, 0.99789147040166537,
0.99807939000147572, 0.99825241963800249, 0.99841157175756612,
0.99855780354537749, 0.99869201896410342, 0.99881507077987919,
0.99892776257169713, 0.99903085072031783, 0.99912504637308008,
0.99921101738120621, 0.99928939020642793, 0.99936075179398243,
0.99942565140925477, 0.99948460243556725, 0.99953808413084055,
0.99958654334107433, 0.99963039616881588, 0.99967002959500151,
0.9997058030527729, 0.9997380499520796, 0.99976707915408669,
0.99979317639460741, 0.99981660565597996, 0.99983761048699349,
0.99985641527065794, 0.99987322643978283, 0.99988823364050627,
0.9999016108440707, 0.99991351740729773, 0.99992409908235813,
0.99993348897656686, 0.99994180846305802, 0.99994916804331102,
0.99995566816260373, 0.99996139997956479, 0.99996644609108087,
0.99997088121389288, 0.9999747728242766, 0.99997818175726283,
0.99998116276689264, 0.99998376504904507, 0.99998603272839748,
0.99998800531109688, 0.9999897181047338, 0.99999120260720731,
0.99999248686606546, 0.99999359580989455, 0.99999455155330497,
0.99999537367704183, 0.99999607948471303, 0.99999668423759169,
0.99999720136891024, 0.99999764267901692, 0.99999801851271974,
0.99999833792008919, 0.99999860880194102, 0.99999883804116285,
0.99999903162099568, 0.99999919473132093, 0.99999933186394951,
0.99999944689785203, 0.99999954317521023, 0.99999962356911842,
0.9999996905437043, 0.9999997462073893, 0.99999979235995395,
0.99999983053402564, 0.99999986203155733, 0.99999988795582073,
0.99999990923939186, 0.99999992666856929, 0.99999994090462185,
0.9999999525022284, 0.99999996192543916, 0.99999996956145198,
0.9999999757324709, 0.99999998070588625, 0.99999998470298701,
0.99999998790639866, 0.99999999046641219, 0.99999999250635507,
0.99999999412713536, 0.99999999541107532, 0.99999999642513482,
0.99999999722361488, 0.99999999785041616, 0.99999999834092179,
0.99999999872356127, 0.99999999902110415, 0.999999999251729,
0.99999999942990214, 0.9999999995670974, 0.99999999967238551,
0.9999999997529132, 0.99999999981429177, 0.99999999986091226,
0.99999999989619848, 0.99999999992281075, 0.99999999994280897,
0.99999999995778199, 0.99999999996895106, 0.99999999997725153,
0.99999999998339661, 0.99999999998792855, 0.99999999999125788,
0.99999999999369404, 0.99999999999546962, 0.99999999999675848,
0.99999999999769018, 0.99999999999836098, 0.99999999999884182,
0.9999999999991851, 0.99999999999942912, 0.99999999999960176,
0.99999999999972344, 0.99999999999980882, 0.99999999999986844,
0.99999999999990985, 0.99999999999993849, 0.99999999999995826,
0.9999999999999718, 0.99999999999998102, 0.99999999999998734,
0.99999999999999156, 0.99999999999999434, 0.99999999999999623,
0.99999999999999756, 0.99999999999999833, 0.99999999999999889,
0.99999999999999933, 0.99999999999999956, 0.99999999999999967],
[0.004839679256608157, 0.014518314708232196, 0.024194781317370146,
0.033867634329702537, 0.043535430700874594, 0.053196729778399343,
0.062850093981481184, 0.072494089478171028, 0.082127286859267318,
0.091748261808381998, 0.10135559576759559, 0.11094787659813189,
0.12052369923548929, 0.13008166633847359, 0.1396203889315854,
0.149138487040224, 0.15863459031818017, 0.16810733866689986,
0.1775553828460123, 0.18697738507462788, 0.19637201962292378,
0.2057379733935473, 0.21507394649238185, 0.22437865278823332,
0.23365082046101029, 0.24288919253798585, 0.25209252741774468,
0.26125959938143528, 0.27038919909096332, 0.27948013407377897,
0.28853122919392815, 0.29754132710905545, 0.30650928871306382,
0.31543399356415341, 0.32431434029798262, 0.33314924702570892,
0.34193765171668933, 0.35067851256563642, 0.35937080834404583,
0.36801353873572923, 0.37660572465630615, 0.38514640855652627,
0.39363465470931258, 0.40206954948043599, 0.41045020158274592,
0.41877574231390807, 0.42704532577760845, 0.43525812908821121,
0.44341335255886638, 0.45151021987308965, 0.45954797823984583,
0.46752589853219251, 0.47544327540954912, 0.48329942742368143,
0.49109369710849909, 0.49882545105378845, 0.50649407996300844,
0.51409899869530262, 0.52163964629188508, 0.52911548598698011,
0.53652600520350313, 0.54387071553368738, 0.55114915270487153,
0.55836087653067612, 0.56550547084780811, 0.57258254343874371,
0.57959172594055286, 0.58653267374013252, 0.59340506585613362,
0.60020860480786919, 0.60694301647150151, 0.61360804992381734,
0.62020347727389946, 0.62672909348302153, 0.63318471617308647,
0.63957018542394595, 0.64588536355993376, 0.65213013492596128,
0.65830440565351434, 0.66440810341690859, 0.67044117718015106,
0.67640359693476726, 0.6822953534289502, 0.68811645788839049,
0.69386694172915098, 0.69954685626294322, 0.70515627239517098,
0.71069528031609952, 0.71616398918551494, 0.72156252681122834,
0.72689103932178822, 0.7321496908337517, 0.73733866311387553,
0.74245815523657133, 0.74750838323697777, 0.75248957975999242,
0.75740199370560735, 0.76224588987088215, 0.76702154858888971,
0.77172926536496189, 0.77636935051056166, 0.78094212877509528,
0.7854479389759812, 0.78988713362728247, 0.79426007856720404,
0.79856715258475064, 0.80280874704583494, 0.80698526551911964,
0.81109712340186979, 0.81514474754608546, 0.81912857588517873,
0.82304905706145048, 0.82690665005461761, 0.83070182381163282,
0.83443505687803154, 0.83810683703103506, 0.84171766091463129,
0.845268033676845, 0.84875846860940574, 0.85218948679001016,
0.8555616167273743, 0.85887539400925583, 0.86213136095362564,
0.86533006626315823, 0.86847206468320381, 0.87155791666339621,
0.87458818802304561, 0.87756344962045685, 0.88048427702630805,
0.88335125020121452, 0.88616495317760102, 0.88892597374599325,
0.89163490314583649, 0.89429233576094092, 0.89689886881964731,
0.89945510209980029, 0.90196163763861015, 0.90441907944747713,
0.90682803323184791, 0.90918910611616555, 0.9115029063739718,
0.91377004316321098, 0.91599112626678247, 0.91816676583838064,
0.92029757215365993, 0.92238415536675167, 0.92442712527215976,
0.92642709107205434, 0.92838466114897955, 0.93030044284398483,
0.93217504224018766, 0.93400906395176819, 0.93580311091839574,
0.93755778420507818, 0.93927368280742685, 0.94095140346232253,
0.94259154046396409, 0.94419468548528074, 0.94576142740468228,
0.94729235213812168, 0.94878804247643844, 0.9502490779279501,
0.9516760345662556, 0.9530694848832123, 0.95442999764704528,
0.95575813776554519, 0.95705446615430867, 0.95831953960997374,
0.95955391068839913, 0.96075812758773727, 0.96193273403634461,
0.96307826918547523, 0.9641952675067007, 0.96528425869399592,
0.96634576757043211, 0.96738031399941515, 0.96838841280040588,
0.96937057366905865, 0.97032730110171428, 0.97125909432418001,
0.97216644722473, 0.97304984829125996, 0.97390978055252553,
0.97474672152339792, 0.97556114315406472, 0.97635351178310747,
0.97712428809438578, 0.9778739270776553, 0.97860287799285017,
0.97931158433795784, 0.9800004838204146, 0.98067000833194951,
0.98132058392680688, 0.98195263080327222, 0.98256656328843284,
0.98316278982609973, 0.98374171296781809, 0.98430372936689803,
0.98484922977538958, 0.98537859904393577, 0.98589221612442779,
0.98639045407539605, 0.98687368007006293, 0.9873422554069905,
0.98779653552325142, 0.98823687001005378, 0.9886636026307527,
0.98907707134117873, 0.98947760831221587, 0.98986553995456117,
0.99024118694560015, 0.99060486425833016, 0.99095688119226799,
0.99129754140627313, 0.99162714295322651, 0.99194597831649611,
0.99225433444812905, 0.9925524928087065, 0.99284072940879875,
0.99311931485195903, 0.99338851437919595, 0.99364858791486321,
0.99389979011390817, 0.99414237041041931, 0.99437657306741556,
0.99460263722781905, 0.99482079696655568, 0.99503128134372565,
0.99523431445879151, 0.9954301155057258, 0.99561889882906796,
0.99580087398083428, 0.99597624577823096, 0.99614521436211756,
0.99630797525617021, 0.99646471942669501, 0.99661563334304204,
0.99676089903857179, 0.99690069417212546, 0.99703519208995417,
0.99716456188805924, 0.9972889684748989, 0.99740857263441673,
0.99752353108934977, 0.99763399656477036, 0.99774011785182315,
0.99784203987161357, 0.99793990373920816, 0.99803384682770879,
0.99812400283235903, 0.99821050183464777, 0.99829347036637139,
0.99837303147361922, 0.99844930478064609, 0.99852240655359858,
0.99859244976406103, 0.99865954415238811, 0.99872379629079289,
0.99878530964615897, 0.99884418464254676, 0.99890051872336505,
0.99895440641317801, 0.99900593937912285, 0.99905520649190882,
0.99910229388637373, 0.99914728502157224, 0.99919026074037243,
0.99923129932853683, 0.99927047657326784, 0.99930786582119258,
0.99934353803577114, 0.99937756185410509, 0.99941000364312937,
0.99944092755517033, 0.99947039558285034, 0.99949846761332672,
0.99952520148184631, 0.99955065302460433, 0.99957487613089102,
0.99959792279451654, 0.99961984316450014, 0.99964068559501362,
0.99966049669456936, 0.99967932137444193, 0.99969720289631714,
0.99971418291915903, 0.99973030154528952, 0.99974559736567226,
0.99976010750439825, 0.99977386766236698, 0.99978691216015914,
0.99979927398009871, 0.99981098480750163, 0.99982207507111021,
0.99983257398270986, 0.99984250957593201, 0.9998519087442399,
0.99986079727810018, 0.9998691999013416, 0.9998771403067036,
0.99988464119057685, 0.99989172428694029, 0.99989841040049765,
0.99990471943901971, 0.99991067044489557, 0.99991628162590052,
0.99992157038518492, 0.99992655335049307, 0.99993124640261599,
0.99993566470308959, 0.99993982272114279, 0.99994373425990657,
0.99994741248189034, 0.99995086993373805, 0.99995411857026928,
0.99995716977782012, 0.99996003439688874, 0.99996272274410092,
0.99996524463350278, 0.99996760939719287, 0.9999698259053057,
0.99997190258535618, 0.99997384744095785, 0.99997566806992644,
0.9999773716817808, 0.99997896511465156, 0.99998045485161269,
0.99998184703644499, 0.99998314748884631, 0.99998436171909932,
0.99998549494220923, 0.99998655209152565, 0.99998753783185845,
0.999988456572102, 0.99998931247737954, 0.99999010948071998,
0.99999085129427967, 0.99999154142012125, 0.99999218316056204,
0.99999277962810373, 0.9999933337549558, 0.99999384830216453,
0.99999432586835901, 0.99999476889812611, 0.9999951796900266,
0.99999556040426218, 0.99999591307000624, 0.99999623959240902,
0.99999654175928732, 0.99999682124751033, 0.9999970796290919,
0.99999731837699934, 0.99999753887068965, 0.99999774240138106,
0.9999979301770735, 0.99999810332732264, 0.99999826290778127,
0.99999840990451427, 0.99999854523809684, 0.99999866976750584,
0.99999878429380995, 0.99999888956367067, 0.99999898627265782,
0.99999907506839147, 0.99999915655351501, 0.99999923128850732,
0.99999929979434243, 0.99999936255500188, 0.9999994200198471,
0.99999947260585864, 0.99999952069974818, 0.99999956465994921,
0.99999960481849215, 0.99999964148276987, 0.99999967493719899,
0.99999970544478167, 0.99999973324857339, 0.99999975857306145,
0.99999978162545866, 0.9999998025969169, 0.9999998216636643,
0.99999983898807077, 0.99999985471964581, 0.99999986899597093,
0.9999998819435727, 0.99999989367873765, 0.99999990430827357,
0.99999991393021925, 0.9999999226345071, 0.99999993050358016,
0.99999993761296668, 0.99999994403181514, 0.99999994982339113,
0.99999995504553996, 0.99999995975111555, 0.9999999639883792,
0.99999996780136857, 0.99999997123024009, 0.99999997431158638,
0.99999997707872956, 0.99999997956199216, 0.99999998178894867,
0.99999998378465627, 0.99999998557186931, 0.99999998717123606,
0.99999998860147998, 0.99999998987956751, 0.99999999102086146,
0.99999999203926282, 0.9999999929473401, 0.99999999375644943,
0.99999999447684351, 0.99999999511777182, 0.99999999568757281,
0.99999999619375801, 0.99999999664308858, 0.99999999704164577,
0.99999999739489542, 0.99999999770774584, 0.99999999798460171,
0.99999999822941255, 0.99999999844571696, 0.99999999863668265,
0.99999999880514356, 0.99999999895363245, 0.9999999990844114,
0.99999999919949911, 0.99999999930069527, 0.99999999938960349,
0.99999999946765128, 0.99999999953610796, 0.99999999959610197,
0.99999999964863506, 0.99999999969459596, 0.99999999973477272,
0.99999999976986287, 0.99999999980048393, 0.99999999982718191,
0.99999999985043897, 0.99999999987068078, 0.99999999988828259,
0.99999999990357502, 0.99999999991684929, 0.99999999992836119,
0.99999999993833555, 0.99999999994697009, 0.99999999995443756,
0.99999999996089006, 0.99999999996646005, 0.99999999997126388,
0.99999999997540301, 0.99999999997896605, 0.99999999998203015,
0.99999999998466282, 0.99999999998692246, 0.99999999998886002,
0.99999999999051992, 0.99999999999194045, 0.99999999999315492,
0.9999999999941922, 0.99999999999507727, 0.99999999999583167,
0.99999999999647415, 0.99999999999702061, 0.99999999999748501,
0.99999999999787914, 0.99999999999821343, 0.99999999999849665,
0.99999999999873623, 0.99999999999893885, 0.99999999999910982,
0.99999999999925415, 0.99999999999937572, 0.99999999999947808,
0.99999999999956413, 0.99999999999963629, 0.99999999999969691,
0.99999999999974776, 0.99999999999979028, 0.99999999999982581,
0.99999999999985545, 0.99999999999988021, 0.99999999999990086,
0.99999999999991807, 0.99999999999993228, 0.99999999999994416,
0.99999999999995404, 0.99999999999996214, 0.99999999999996891,
0.99999999999997446, 0.99999999999997902, 0.99999999999998279,
0.9999999999999859, 0.99999999999998856, 0.99999999999999067,
0.99999999999999234, 0.99999999999999378, 0.99999999999999489,
0.99999999999999589, 0.99999999999999667, 0.99999999999999722,
0.99999999999999778, 0.99999999999999822, 0.99999999999999856,
0.99999999999999878, 0.999999999999999, 0.99999999999999922,
0.99999999999999933, 0.99999999999999944, 0.99999999999999956,
0.99999999999999967, 0.99999999999999967]]

_weights_raw = [[1.5707963267948966, 0.47399405975882763,
0.010887497126362172, 2.1003781820550314e-06, 7.9038848489404628e-15],
[1.1594423636956512, 0.1055739271950269, 0.00035964260276217911,
9.0313644924399895e-10], [1.4553471458010554, 0.7971950206923385,
0.2427198383546284, 0.038005280124076696, 0.0023544942983976147,
3.5773450217506455e-05, 6.4641792620795718e-08,
4.8109113057895697e-12], [1.5410567021283166, 1.3234519742522963,
0.97906003369596462, 0.62601508951350437, 0.34578758042158264,
0.16359293579040496, 0.06499777046191256, 0.020993286445003784,
0.0052642876479594243, 0.00096561858887122393, 0.00012035938406856259,
9.3226973696303261e-06, 4.0280278172197421e-07,
8.5191780490141725e-09, 7.5278521112986038e-11,
2.2928623601543418e-13], [1.563305054242587, 1.5047152662876699,
1.3943643802667678, 1.2444850981264253, 1.0703211337374681,
0.88747265096304762, 0.70964809112846816, 0.5472326786754631,
0.40676174631434558, 0.29113763034097623, 0.20031261394323849,
0.13216289262805114, 0.083348331743049883, 0.050038774961386479,
0.028458348886671862, 0.015244376957518459, 0.007640876592472313,
0.003556956574951402, 0.0015251423341664566, 0.00059682473905008006,
0.00021100288771551301, 6.6649567776243533e-05,
1.8580522005538362e-05, 4.5105405335083941e-06,
9.3947825818022815e-07, 1.6518339086789827e-07,
2.4081813751848136e-08, 2.8542259859548276e-09,
2.6910682940042176e-10, 1.9705822598982941e-11,
1.0915108213365889e-12, 4.4419868000740229e-14], [1.5689199612017777,
1.5539939783880778, 1.5245898265740143, 1.4815786027966389,
1.4262077425689121, 1.360035628916032, 1.2848530900109116,
1.2025978631198948, 1.115268180444368, 1.024841100593552,
0.93320020003002846, 0.84207593016479054, 0.75300052794670325,
0.66727801232836681, 0.58596863741528615, 0.50988628652976042,
0.43960671055853207, 0.37548422694283501, 0.31767446030338542,
0.26616086277936024, 0.2207830375277629, 0.1812652425056672,
0.14724382372916023, 0.11829268057710064, 0.093946176423240463,
0.073719163747397357, 0.057123991189761157, 0.043684504914685521,
0.03294715654838283, 0.024489395226277848, 0.017925562395446772,
0.012910534098173223, 0.0091413733763260618, 0.0063572693223366899,
0.0043380505974901862, 0.0029015691239633098, 0.0019002518475230415,
0.0012171121915778493, 0.00076149581791144002, 0.00046480663271875966,
0.00027641947019633128, 0.00015993820066637185, 8.990620188043277e-05,
4.9024939170929811e-05, 2.589038624924408e-05, 1.3219788501280385e-05,
6.5149351029667193e-06, 3.0930945044569481e-06,
1.4119930178544728e-06, 6.185085907766098e-07, 2.5942209610054896e-07,
1.039548685293142e-07, 3.9704520472133739e-08, 1.4418578853516393e-08,
4.9655729592623747e-09, 1.6173420315412483e-09,
4.9680097522273635e-10, 1.4348674747672081e-10,
3.8844160639259184e-11, 9.8240794834700952e-12,
2.3131618382285761e-12, 5.0522944374479008e-13,
1.0197201140680699e-13, 1.8942659744520268e-14], [1.5703270132945997,
1.5665778326498838, 1.5591078016852924, 1.5479731881577019,
1.5332574201113065, 1.5150699414847975, 1.4935447252935454,
1.4688384762437743, 1.4411285606765196, 1.4106107066215925,
1.3774965203487746, 1.3420108680696206, 1.3043891723552221,
1.26487467242998, 1.223715695861495, 1.181162986414364,
1.1374671291248788, 1.0928761091614194, 1.0476330359526769,
1.0019740585887404, 0.95612649282121942, 0.91030717428988117,
0.86472104704990316, 0.8195599912093593, 0.77500188862984953,
0.7312099212866694, 0.68833209309422938, 0.64650096281723346,
0.6058335731239739, 0.56643155888902141, 0.52838141649423598,
0.49175491507006064, 0.45660963031271251, 0.42298958164836803,
0.39092595402913038, 0.36043788647200248, 0.3315333105262927,
0.30420982311460981, 0.27845557957980099, 0.25425019423229234,
0.2315656371829603, 0.21036711772623884, 0.19061394597380152,
0.1722603658046826, 0.15525635347333866, 0.13954837738896861,
0.12508011563888563, 0.11179312877189976, 0.099627486184716493,
0.088522345168642338, 0.078416482281589373, 0.069248777219549446,
0.060958649781988616, 0.053486450867395556, 0.046773808709405666,
0.040763931781289293, 0.035401869967581538, 0.030634735735878799,
0.026411887148046816, 0.022685074635737313, 0.019408553536381223,
0.016539164447442561, 0.014036383512017542, 0.011862344799755424,
0.009981836994199661, 0.008362276640450212, 0.0069736602440269172,
0.0057884975407045507, 0.0047817282751241577, 0.0039306248301597966,
0.0032146830363540936, 0.0026155034585286963, 0.0021166654027430427,
0.0017035958096313611, 0.0013634350991709838, 0.0010849019074448728,
0.00085815850926850034, 0.0006746785539219728, 0.00052711855781033138,
0.00040919440155579094, 0.00031556387426118302, 0.0002417160992847346,
0.00018386846877574363, 0.00013887151328137917,
0.00010412194247231291, 7.7483917460299942e-05,
5.7218457631061809e-05, 4.1920747934882009e-05,
3.0464997845978875e-05, 2.1956411516791026e-05,
1.5689759954022835e-05, 1.1113999481239854e-05,
7.8023547967223386e-06, 5.427277502976316e-06, 3.7396995903438754e-06,
2.552023266926819e-06, 1.724320906628101e-06, 1.1532589410065152e-06,
7.6330460999076952e-07, 4.9982222350171318e-07,
3.2371390160261613e-07, 2.0730694529561201e-07, 1.312347084298369e-07,
8.2099125472690723e-08, 5.0740273538467302e-08, 3.097118531188212e-08,
1.8664511136507008e-08, 1.1101683520466016e-08,
6.5152444038849829e-09, 3.7713332423122999e-09, 2.152437220703037e-09,
1.2108289834850724e-09, 6.7110950080573184e-10,
3.6635308936030416e-10, 1.968955240834545e-10, 1.0414318589695631e-10,
5.4188884382285525e-11, 2.7726489356546086e-11,
1.3944451725678922e-11, 6.8903599760390521e-12,
3.3436719426664351e-12, 1.5927561609451147e-12,
7.4441741070600054e-13, 3.4120708898195602e-13, 1.532997422869343e-13,
6.7479048738455257e-14, 2.9085565863642656e-14,
1.2269828059408386e-14], [1.5706789845324045, 1.5697405796821542,
1.5678655460248356, 1.565057429469582, 1.5613215334711525,
1.5566649006344921, 1.5510962883454735, 1.5446261385615974,
1.5372665419278457, 1.5290311964129735, 1.5199353606900581,
1.5099958025119085, 1.4992307423567288, 1.4876597926421165,
1.4753038928258437, 1.4621852407298452, 1.4483272204392692,
1.4337543271413082, 1.4184920892787132, 1.4025669884004313,
1.3860063770966571, 1.3688383954077912, 1.3510918860964138,
1.3327963091684598, 1.3139816560244277, 1.2946783636137895,
1.2749172289558983, 1.2547293243787911, 1.2341459138134885,
1.2131983704658893, 1.1919180961713192, 1.170336442718408,
1.1484846354094242, 1.1263936991036976, 1.1040943869694795,
1.0816171121477507, 1.058991882509243, 1.036248238663499,
1.01341519535633, 0.99052118636968556, 0.96759401301592729,
0.94466079629688759, 0.92174793277709244, 0.89888105420019826,
0.87608499085820257, 0.85338373870437401, 0.83080043018326422,
0.80835730873459577, 0.78607570691242756, 0.76397602804670794,
0.74207773136129351, 0.72039932045063682, 0.69895833500675009,
0.67777134567862696, 0.65685395193814344, 0.63622078281943528,
0.61588550039294132, 0.59586080583056744, 0.57615844791482407,
0.5567892338421766, 0.53776304216926352, 0.51908883774992776,
0.50077468851121565, 0.48282778391745929, 0.46525445497330348,
0.44806019561892718, 0.43124968537372044, 0.41482681308824493,
0.39879470166833492, 0.38315573363965716, 0.36791157742587716,
0.35306321421868481, 0.33861096532331764, 0.32455451986876171,
0.31089296277753281, 0.29762480289571891, 0.28474800118983673,
0.27225999892289782, 0.26015774572793565, 0.24843772750300555,
0.23709599405737453, 0.22612818644417443, 0.2155295639202377,
0.205295030479093, 0.19541916090819791, 0.18589622632638061,
0.176720219162154, 0.16788487753804579, 0.15938370903033672,
0.15121001377763804, 0.1433569069155273, 0.13581734031803899,
0.12858412363013969, 0.12164994457844075, 0.1150073885502861,
0.10864895743403555, 0.10256708771582605, 0.096754167830366625,
0.091202554765387855, 0.085904589921261279, 0.080852614229013353,
0.076038982531516211, 0.071456077234027637, 0.067096321231512254,
0.062952190121293619, 0.059016223710593868, 0.055281036829401678,
0.051739329459904407, 0.048383896194415327, 0.045207635034351781,
0.0422035555433629, 0.039364786368195272, 0.036684582141313253,
0.034156329779679834, 0.031773554194445865, 0.029529923426611253,
0.027419253224004608, 0.025435511075194032, 0.023572819716183867,
0.021825460125985068, 0.02018787402736397, 0.018654665909286331,
0.017220604587772879, 0.01588062432207921, 0.014629825503299443,
0.013463474932675827, 0.012377005707067956, 0.011366016729200165,
0.010426271860458278, 0.0095536987341471053, 0.0087443872472436433,
0.0079945877487883638, 0.0073007089431408228, 0.0066593155263875853,
0.0060671255742241973, 0.0055210076996368776, 0.0050179779986800309,
0.0045551968025813227, 0.0041299652543018194, 0.0037397217275349161,
0.0033820381059402218, 0.0030546159401774568, 0.0027552825000274079,
0.0024819867385632937, 0.0022327951849643321, 0.0020058877821454804,
0.0017995536849122319, 0.0016121870338395175, 0.0014422827195194924,
0.0012884321512273476, 0.0011493190434186656, 0.0010237152328001708,
0.00091047653801050021, 0.00080853867321320017,
0.00071691322614388022, 0.00063468371037225498,
0.00056100170074168819, 0.00049508306013895881,
0.00043620426492967486, 0.00038369883557537682,
0.00033695387813145934, 0.0002954067415157112, 0.00025854179463999957,
0.00022588732671723907, 0.00019701257329645251,
0.00017152486984473234, 0.0001490669339898911, 0.00012931427686515968,
0.00011197274336051968, 9.6776180486789871e-05,
8.3484232500824219e-05, 7.1880260924910851e-05,
6.1769387122151078e-05, 5.297665466321199e-05, 4.5345308338974891e-05,
3.8735186338307944e-05, 3.3021221820270669e-05, 2.809204986475875e-05,
2.38487155839355e-05, 2.0203479017360292e-05, 1.707871231484305e-05,
1.440588463076241e-05, 1.2124630109703133e-05, 1.0181894333385653e-05,
8.5311546204519538e-06, 7.1317096210433858e-06,
5.9480337245206792e-06, 4.9491918983246135e-06,
4.1083106960503722e-06, 3.4021013105181507e-06,
2.8104307002338995e-06, 2.3159369824860532e-06,
1.9036854608729812e-06, 1.5608618368723465e-06,
1.2764993418742922e-06, 1.0412367157853948e-06,
8.4710414892483834e-07, 6.8733449371184622e-07,
5.5619724000366692e-07, 4.4885293149070084e-07,
3.6122587908267623e-07, 2.8989319969950969e-07,
2.3198837446420093e-07, 1.8511767830171647e-07, 1.472879828566203e-07,
1.168445760810093e-07, 9.2417774578187179e-08, 7.2877228705614819e-08,
5.7292935544135459e-08, 4.4902081228023304e-08,
3.5080931986258981e-08, 2.7321082825550941e-08,
2.1209454405685905e-08, 1.6411502681125191e-08,
1.2657172709310893e-08, 9.729188082084513e-09, 7.4533211651686276e-09,
5.6903371835151018e-09, 4.3293476204458833e-09,
3.2823458536269916e-09, 2.4797308681713626e-09,
1.8666536886389798e-09, 1.4000462608425102e-09,
1.0462142732394604e-09, 7.788941950189275e-10, 5.7769095782867884e-10,
4.2682652915972146e-10, 3.141414009193369e-10, 2.3030100466590506e-10,
1.6816749876163024e-10, 1.2230446211359049e-10,
8.8587961570359638e-11, 6.3902401686317703e-11,
4.5903663103565616e-11, 3.2835417792980142e-11,
2.3387287876190935e-11, 1.6585786779074032e-11,
1.1710830641673521e-11, 8.2321058152754872e-12,
5.7607858638855935e-12, 4.0130603518120903e-12,
2.7827112733436244e-12, 1.9205876165402407e-12,
1.3193145048381105e-12, 9.019556641801101e-13, 6.1364722178425341e-13,
4.154539125128366e-13, 2.7987936479242075e-13, 1.8760135490086789e-13,
1.2510968035027579e-13, 8.3005747281759854e-14,
5.4784768584025151e-14, 3.5968115714904415e-14,
2.3488384657259526e-14, 1.5255880957852487e-14,
9.8546412882097142e-15], [1.5707669903612154, 1.5705323197244045,
1.5700630895380394, 1.5693595218799634, 1.5684219496254015,
1.5672508161574863, 1.565846674981916, 1.5642101892462736,
1.5623421311646761, 1.5602433813485397, 1.5579149280443865,
1.5553578662797383, 1.5525733969182682, 1.5495628256255038,
1.5463275617464913, 1.5428691170969544, 1.5391891046695818,
1.5352892372572031, 1.5311713259947051, 1.5268372788216524,
1.5222890988676734, 1.5175288827627629, 1.5125588188747536,
1.5073811854762822, 1.5019983488436708, 1.4964127612902118,
1.4906269591364232, 1.4846435606199033, 1.478465263747488,
1.4720948440924535, 1.4655351525395799, 1.4587891129809247,
1.4518597199652019, 1.4447500363037056, 1.4374631906357354,
1.4300023749565247, 1.4223708421106789, 1.4145719032541577,
1.4066089252878411, 1.3984853282657281, 1.3902045827808134,
1.3817702073316911, 1.3731857656729149, 1.3644548641521403,
1.3555811490370508, 1.3465683038350438, 1.3374200466086337,
1.3281401272894848, 1.3187323249939624, 1.3092004453430379,
1.2995483177893508, 1.2897797929541723, 1.2798987399769681,
1.2699090438802003, 1.2598146029519504, 1.249619326148881,
1.2393271305219937, 1.2289419386675617, 1.2184676762055617,
1.2079082692878351, 1.1972676421381565, 1.1865497146262882,
1.1757583998780374, 1.1648976019232373, 1.1539712133835052,
1.142983113201532, 1.1319371644135836, 1.1208372119668051,
1.1096870805828289, 1.0984905726691057, 1.0872514662792854,
1.0759735131238901, 1.0646604366324326, 1.0533159300680419,
1.0419436546955783, 1.0305472380041241, 1.0191302719846564,
1.0076963114636173, 0.99624887249301786, 0.98479143079761977,
0.9733274202796679, 0.96186023158154899, 0.95039321070669125,
0.93892965769892056, 0.9274728253804293, 0.91602591814842627,
0.90459209083046976, 0.89317444759841125, 0.88177604094080342,
0.87039987069356928, 0.85904888312865113, 0.84772597010030415,
0.83643396824862792, 0.82517565825988359, 0.81395376418307352,
0.80277095280221766, 0.79162983306369472, 0.78053295555798508,
0.76948281205508651, 0.75848183509284162, 0.74753239761736223,
0.73663681267471037, 0.72579733315294082, 0.71501615157358878,
0.70429539993164125, 0.69363714958301204, 0.68304341117850087,
0.67251613464319915, 0.66205720920027222, 0.65166846343803897,
0.64135166541923649, 0.63110852283135122, 0.62094068317687301,
0.61084973400232656, 0.60083720316491362, 0.59090455913559714,
0.58105321133744381, 0.57128451051804774, 0.56159974915484179,
0.55200016189211265, 0.54248692600852277, 0.53306116191396002,
0.5237239336745243, 0.51447624956447502, 0.50531906264396054,
0.4962532713613701, 0.48727972017914467, 0.47839920022190258,
0.46961244994574225, 0.46092015582759982, 0.4523229530735472,
0.44382142634494048, 0.43541611050133333, 0.42710749135909343,
0.41889600646467323, 0.41078204588150879, 0.40276595298952989,
0.39484802529629692, 0.3870285152587879, 0.37930763111488647,
0.37168553772363727, 0.36416235741336367, 0.35673817083675585,
0.34941301783206674, 0.34218689828956761, 0.33505977302244738,
0.3280315646413523, 0.32110215843179446, 0.31427140323366992,
0.30753911232216347, 0.30090506428932767, 0.29436900392565435,
0.28793064310097505, 0.28158966164405436, 0.2753457082202585,
0.26919840120670657, 0.26314732956433157, 0.25719205370630505,
0.25133210636229608, 0.24556699343806129, 0.23989619486987812,
0.23431916547336357, 0.22883533578623222, 0.2234441129045743,
0.21814488131224963, 0.21293700370301835, 0.20781982179504496,
0.20279265713742986, 0.19785481190844692, 0.19300556970517771,
0.18824419632425368, 0.18356994053343459, 0.17898203483376865,
0.17447969621209325, 0.17006212688365768, 0.1657285150246558,
0.16147803549448073, 0.15730985054752142, 0.15322311053433854,
0.14921695459206999, 0.14529051132393034, 0.14144289946767827,
0.13767322855294467, 0.13398059954731795, 0.13036410549110214,
0.12682283212066947, 0.12335585848034168, 0.11996225752274438,
0.11664109669758925, 0.11339143852884555, 0.1102123411802767,
0.10710285900931957, 0.10406204310929884, 0.10108894183997232,
0.098182601346412338, 0.095342066066235603, 0.092566379225200765,
0.089854583321197681, 0.087205720596662761, 0.084618833499454899,
0.082092965132237739, 0.079627159690415325, 0.077220462888675026,
0.074871922376196109, 0.072580588140586905, 0.070345512900616539,
0.06816575248781423, 0.066040366217008636, 0.063968417245887671,
0.061948972923659334, 0.059981105128898912, 0.058063890596670359,
0.056196411235012941, 0.054377754430885536, 0.052607013345666018,
0.05088328720030208, 0.049205681550215541, 0.047573308550061505,
0.045985287208447224, 0.044440743632716773, 0.042938811263909818,
0.041478631102003199, 0.040059351921547928, 0.038680130477812498,
0.03734013170354792, 0.036038528896488981, 0.034774503897708434,
0.033547247260941881, 0.032355958413002373, 0.031199845805404039,
0.030078127057316807, 0.028990029089972971, 0.027934788252649608,
0.026911650440350147, 0.025919871203310071, 0.024958715848452422,
0.024027459532919914, 0.02312538734981039, 0.02225179440624488,
0.021405985893896192, 0.020587277152108771, 0.019794993723739936,
0.019028471403854021, 0.018287056281401547, 0.017570104774016441,
0.016876983656064496, 0.016207070080078045, 0.01555975159171117,
0.014934426138351707, 0.014330502071526136, 0.013747398143234441,
0.013184543496352653, 0.012641377649241283, 0.012117350474698557,
0.011611922173397841, 0.011124563241949216, 0.010654754435725765,
0.010201986726595213, 0.0097657612556987586, 0.0093455892814183501,
0.0089409921226749536, 0.0085515010976999935, 0.008176657458422781,
0.0078160123206168046, 0.0074691265899479962, 0.007135570884068145,
0.0068149254508966979, 0.0065067800832341689, 0.006210734029850366,
0.0059263959031902649, 0.0056533835838405867, 0.00539132412189928,
0.0051398536353902896, 0.0048986172058651566, 0.0046672687713326779,
0.0044454710166571786, 0.004232895261565321, 0.0040292213464004443,
0.0038341375157628873, 0.0036473403001733564, 0.0034685343958958149,
0.0032974325430549026, 0.0031337554021818475, 0.0029772314293214672,
0.0028275967498314881, 0.0026845950310038051, 0.0025479773536359399,
0.0024175020826789672, 0.0022929347370867241, 0.002174047858989012,
0.0020606208823096862, 0.0019524400009484329, 0.0018492980366429563,
0.001750994306625997, 0.0016573344911894744, 0.0015681305012654682,
0.0014832003461315113, 0.0014023680013449933, 0.0013254632770089599,
0.001252321686468903, 0.0011827843155374346, 0.0011166976923408867,
0.0010539136578791497, 0.00099428923738701237, 0.00093768651258245897,
0.00088397249488428233, 0.00083301899967838384,
0.00078470252170904095, 0.00073890411166832961,
0.00069550925405371467, 0.00065440774636073599,
0.00061549357967444381, 0.00057866482072014061,
0.00054382349543071482, 0.00051087547408468334, 0.0004797303580658421,
0.00045030136829223309, 0.00042250523535892202,
0.00039626209143595194, 0.00037149536395962048, 0.0003481316711521567,
0.00032610071940172467, 0.00030533520253163404,
0.00028577070298459553, 0.00026734559494487239,
0.00025000094941821869, 0.00023368044128662074,
0.00021833025835199806, 0.00020389901238021595,
0.00019033765215410088, 0.00017759937854138611,
0.00016563956158101883, 0.00015441565958867183,
0.00014388714027985624, 0.00013401540390669804,
0.00012476370840206142, 0.00011609709652257332,
0.00010798232497987161, 0.00010038779554743018,
9.3283488128260679e-05, 8.6640895766982464e-05, 8.043296158788113e-05,
7.4634017638933599e-05, 6.9219725620095479e-05,
6.4167019472661328e-05, 5.9454049805037411e-05,
5.5060130128918706e-05, 5.0965684878605601e-05,
4.7152199185009529e-05, 4.3602170374808649e-05,
4.0299061164229207e-05, 3.7227254515987809e-05,
3.4372010127132377e-05, 3.1719422514743921e-05,
2.9256380665828638e-05, 2.6970529217121763e-05, 2.485023113004862e-05,
2.2884531825640584e-05, 2.1063124743877186e-05,
1.9376318291631138e-05, 1.7815004143204292e-05,
1.6370626857298925e-05, 1.5035154774202153e-05,
1.3801052156959672e-05, 1.2661252540368942e-05, 1.160913325173803e-05,
1.0638491067533148e-05, 9.7435189702559327e-06,
8.9187839701776924e-06, 8.1592059568735016e-06,
7.4600375458780393e-06, 6.8168448861900489e-06,
6.2254893948125284e-06, 5.6821103849989794e-06,
5.1831085554066438e-06, 4.7251303079083554e-06,
4.3050528624040491e-06, 3.9199701375821337e-06,
3.5671793672169824e-06, 3.2441684222462886e-06,
2.9486038095468866e-06, 2.6783193190197445e-06,
2.4313052913022723e-06, 2.20569847914213e-06, 1.999772476196881e-06,
1.8119286877567957e-06, 1.6406878186311214e-06, 1.484681854180552e-06,
1.3426465112265783e-06, 1.2134141363128024e-06,
1.0959070295391519e-06, 9.8913117292960636e-07,
8.9217034303126102e-07, 8.0418058817190635e-07,
7.2438505152584047e-07, 6.5206912185142786e-07,
5.8657589446743729e-07, 5.2730192572797168e-07,
4.7369326493692859e-07, 4.2524174831055166e-07,
3.8148154025169708e-07, 3.4198590783917109e-07,
3.0636421506134524e-07, 2.7425912393276742e-07,
2.4534399022691824e-07, 2.1932044213566217e-07,
1.9591613072739032e-07, 1.7488264161983546e-07,
1.5599355781093362e-07, 1.390426641209686e-07, 1.2384228419196644e-07,
1.1022174146574134e-07, 9.8025936020086539e-08,
8.7114029583546522e-08, 7.7358231473124018e-08,
6.8642678606155595e-08, 6.086240312794815e-08, 5.3922381570469818e-08,
4.7736659815073818e-08, 4.2227548473858905e-08,
3.7324883630467114e-08, 3.2965348191961855e-08, 2.90918493995293e-08,
2.5652948327274163e-08, 2.2602337465920129e-08,
1.9898362742051416e-08, 1.7503586564151272e-08,
1.5384388714510773e-08, 1.3510602121525352e-08,
1.1855180750426443e-08, 1.0393897042555986e-08,
9.1050665142996789e-09, 7.9692972972428289e-09,
6.9692625613835632e-09, 6.0894939138255541e-09, 5.316194006656042e-09,
4.6370667201652879e-09, 4.0411634115579411e-09,
3.5187438352893102e-09, 3.0611504494992836e-09, 2.660694924128993e-09,
2.3105557605502919e-09, 2.0046860202951919e-09,
1.7377302420944188e-09, 1.5049497022646445e-09,
1.3021552438576751e-09, 1.125646965222046e-09, 9.7216011903255561e-10,
8.3881662871751807e-10, 7.2308168083258343e-10,
6.2272489957101566e-10, 5.357856535150206e-10, 4.6054208517211305e-10,
3.9548349103350743e-10, 3.3928571406393028e-10,
2.9078924189079686e-10, 2.4897973270713828e-10,
2.1297071722279234e-10, 1.8198824907069786e-10,
1.5535729806617409e-10, 1.3248970078368273e-10,
1.1287350120540181e-10, 9.6063530847135813e-11, 8.167309290867176e-11,
6.9366628749137163e-11, 5.8853257465363601e-11,
4.9881090658510132e-11, 4.2232234708501142e-11,
3.5718402128590986e-11, 3.0177061927489745e-11,
2.5468066442476961e-11, 2.1470698895764555e-11,
1.8081092035076847e-11, 1.5209973709403379e-11,
1.2780700158998205e-11, 1.0727542217097506e-11,
8.9941935774314693e-12, 7.5324738204021823e-12, 6.301202052049963e-12,
5.2652198304396697e-12, 4.394544567543408e-12, 3.6636368316980943e-12,
3.0507669642582804e-12, 2.5374681895059997e-12,
2.1080649623244207e-12, 1.7492666844787161e-12,
1.4498181465433272e-12, 1.2001991356765433e-12,
9.9236660505380152e-13, 8.1953364276282883e-13,
6.7598021889954747e-13, 5.5689134076956792e-13,
4.5821881763055378e-13, 3.765633373930999e-13, 3.0907399626587387e-13,
2.5336280575473505e-13, 2.0743203619866296e-13,
1.6961254793037366e-13, 1.3851151533883393e-13,
1.1296817015903614e-13, 9.2016382285202011e-14,
7.4853062895035066e-14, 6.0811518871299709e-14,
4.9339012226234644e-14, 3.9977885958156015e-14,
3.2349710684969884e-14, 2.6141986431203328e-14,
2.1097002783443094e-14, 1.7002519756684781e-14,
1.3683982429057495e-14, 1.0998025840278929e-14,
8.8270638010615689e-15]]

def _mirror_abscissas(a):
    return a + [-v for v in a if v > 0]

def _mirror_weights(w, a):
    # special case for abscissa == 0, to prevent duplicate evaluations
    return w + [v for idx, v in enumerate(w) if a[idx] > 0]

_abscissas = [array(_mirror_abscissas(a)) for a in _abscissas_raw]
_weights = [array(_mirror_weights(w, a))
            for w, a in zip(_weights_raw, _abscissas_raw)]
